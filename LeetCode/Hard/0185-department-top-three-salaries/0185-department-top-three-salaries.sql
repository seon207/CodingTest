SELECT A.NAME DEPARTMENT, C.NAME EMPLOYEE, C.SALARY SALARY FROM (SELECT DEPARTMENTID, NAME, DENSE_RANK() OVER(PARTITION BY DEPARTMENTID ORDER BY SALARY DESC) as ranking, SALARY FROM EMPLOYEE) C JOIN DEPARTMENT A ON C.DEPARTMENTID = A.ID WHERE C.RANKING <= 3;
